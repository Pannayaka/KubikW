#include <iostream>
#include <vector>
#include <string>
#include <unistd.h>     // usleep
#include <termios.h>    // terminal input
#include <fcntl.h>      // file control

// Set terminal to raw input mode (non-blocking)
void setNonBlocking(bool enable) {
    static struct termios oldt, newt;
    if (enable) {
        tcgetattr(STDIN_FILENO, &oldt);      // get current terminal settings
        newt = oldt;
        newt.c_lflag &= ~(ICANON | ECHO);    // disable line buffering & echo
        tcsetattr(STDIN_FILENO, TCSANOW, &newt);
        fcntl(STDIN_FILENO, F_SETFL, O_NONBLOCK); // non-blocking input
    } else {
        tcsetattr(STDIN_FILENO, TCSANOW, &oldt);  // restore original settings
    }
}

// Clear the terminal screen
void clearScreen() {
    std::cout << "\033[2J\033[H" << std::flush;
}

// Check if a key was pressed (non-blocking)
int getKeyPressed() {
    char ch;
    if (read(STDIN_FILENO, &ch, 1) > 0) {
        return ch;
    }
    return -1; // No key pressed
}

int main() {
    std::vector<std::string> frames = {
        R"(
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ████████████████████████████████████████████████████████  █████████████████████████████████████
            █████████████████████      ████  ███   █████    █████      ████  ██   █████████████████████████
            █████████████████████  ██  ████  ███   ████      ███   ████████     ███████████████████████████
            █████████████████████       ███  ███   ███   ██  ███   ████████     ███████████████████████████
            █████████████████████  ██   ███   ██   ███        ███    █ ████  █    █████████████████████████
            █████████████████████      █████      ███   ████   ████    ████  ███   ████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████     ████  ████  ████        ███       █████████████████████████████
            ███████████████████████████   ██████  ████  ███   ████   ████   ███████████████████████████████
            ████████████████████████████     ███        ███   █████  ████   ████████████████████████    ██████
            ███████████████████████████ ██   ███  ████  ████   ██    ████   ███████████████████████████████
            ███████████████████████████     ████  ████  █████      ██████   ███████████████████████████████
            ██████████████████████████████████████████████████████████████████████████████████      ████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████                         █████████
            █████████████████       █████████████████████████████████████████████            █████████████████
            ████████████████          ██████████████████████████████████████████           █    ███████████████
            ███████████████            █████████████████████████    █                              ███   █████
            ███████████████            █████████████████    █   ██████  ██████████         ████     ███████████
            ████████████████          ████          █   █████████          ██████             █████████████
            █████████████████        █████          █████████████                                       ████████
            ███████████                        ████████████████████                     ███    ████████████
            ██████████                         █████████████████████████         ██    █████    ███████████
            ██████████    █████   █████████   ███████████████████████████   ███████    ████████████████████
            ██████████   ██████   █████████████████████████████████████████████████    ████████████████████
            ██████████   ██████   █████████████████████████████████████████████████     ███████████████████
            █████████████████      ██████████████████████████████████████████████         █████████████████
            ████████████████         ██████████████████████████████████████████       █     ███████████████
            ███████████████          █████████████████████████████████████████     ██████   ███████████████
            ██████████████     ███    █████████████████████████████████████████  ██████████████████████████
            ███████████████    ████    ████████████████████████████████████████████████████████████████████
            █████████████████████████ █████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
        )",
        R"(
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ████████████████████████████████████████████████████████  █████████████████████████████████████
            █████████████████████      ████     █████    █████      ████  ██   █████████████████████████
            █████████████████████  ██  ████  ███   ████      ███   ████████     ███████████████████████████
            █████████████████████       ███  ███   ███   ██  ███   ████████     ███████████████████████████
            █████████████████████  █ ███   ██   ███        ███    █ ████  █    █████████████████████████
            █████████████████████      █████      ███   ████   ████    ████  ███   ████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████     ████  ████  ████        ███       █████████████████████████████ 
            ███████████████████████████   ██████  ██  ███  ███   ████   ███████████████████████████████
            ████████████████████████████     ███        ███   █████  ████   ███████████████████████████████
            ███████████████████████████ ██   ███  ████  ████   ██    ████   ███████████████████████████████
            ███████████████████████████     ████  ████  █████      ██████   ███████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████     ███████████████████
            █████████████████       █████████████████████████████████████████████         █████████████████
            ████████████████          ██████████████████████████████████████████           ████████████████
            ███████████████            █████████████████████████████████████████          █████████████████
            ██████████            █████████████████████████████  ██████████          █████████████████
            ████████████████          ████          █████████████          ██████             █████████████
            █████████████████        █████          █████████████                             █████████████
            ███████████                        ████████████████████                     ███    ████████████
            ██████████                         █████████████████████████         ██    █████    ███████████
            ██████████    █████   █████████   ███████████████████████████   ███████    ████████████████████
            ██████████   ██████   █████████████████████████████████████████████████    ████████████████████
            ██████████   ██████   ███████████████████████empty██████████████████████████     ███████████████████
            ██████████████      ██████████████████████████████████████████████         █████████████████
            ████████████████         ██████████████████████████████████████████       █     ███████████████
            ███████████████          █████████████████████████████████████████     ██████   ███████████████
            ██████████████     ███    █████████████████████████████████████████  ██████████████████████████
            ███████████████    ████    ████████████████████████████████████████████████████████████████████
            █████████████████████████ █████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ██████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
        )",
        R"(
          ``███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ████████████████████████████████████████████████████████  █████████████████████████████████████
            █████████████████████      ████  ███   █████    █████      ████  ██   █████████████████████████
            █████████████████████  ██  ████  ███   ████      ███   ████████     ███████████████████████████
            █████████████████████       ███  ███   ███   ██  ███   ████████     ███████████████████████████
            █████████████████████  ██   ███   ██   ███        ███    █ ████  █    █████████████████████████
            █████████████████████      █████      ███   ████   ████    ████  ███   ████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████     ████  ████  ████        ███       █████████████████████████████
            ███████████████████████████   ██████  ████  ███   ████   ████   ███████████████████████████████
            ████████████████████████████     ███        ███   █████  ████   ███████████████████████████████
            ███████████████████████████ ██   ███  ████  ████   ██    ████   ███████████████████████████████
            ███████████████████████████     ████  ████  █████      ██████   ███████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████     ███████████████████
            █████████████████       █████████████████████████████████████████████         █████████████████
            ████████████████          ██████████████████████████████████████████           ████████████████
            ███████████████            █████████████████████████████████████████          █████████████████
            ███████████████            █████████████████████████████  ██████████          █████████████████
            ████████████████          ████          █████████████          ██████             █████████████
            █████████████████        █████          █████████████                             █████████████
            ███████████                        ████████████████████                     ███    ████████████
            ██████████                         █████████████████████████         ██    █████    ███████████
            ██████████    █████   █████████   ███████████████████████████   ███████    ████████████████████
            ██████████   ██████   █████████████████████████████████████████████████    ████████████████████
            ██████████   ██████   █████████████████████████████████████████████████     ███████████████████
            █████████████████      ██████████████████████████████████████████████         █████████████████
            ████████████████         ██████████████████████████████████████████       █     ███████████████
            ███████████████          █████████████████████████████████████████     ██████   ███████████████
            ██████████████     ███    █████████████████████████████████████████  ██████████████████████████
            ███████████████    ████    ████████████████████████████████████████████████████████████████████
            █████████████████████████ █████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
        )",
        R"(
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ████████████████████████████████████████████████████████  █████████████████████████████████████
            █████████████████████      ████  ███   █████    █████      ████  ██   █████████████████████████
            █████████████████████  ██  ████  ███   ████      ███   ████████     ███████████████████████████
            █████████████████████       ███  ███   ███   ██  ███   ████████     ███████████████████████████
            █████████████████████  ██   ███   ██   ███        ███    █ ████  █    █████████████████████████
            █████████████████████      █████      ███   ████   ████    ████  ███   ████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████     ████  ████  ████        ███       █████████████████████████████
            ███████████████████████████   ██████  ████  ███   ████   ████   ███████████████████████████████
            ████████████████████████████     ███        ███   █████  ████   ███████████████████████████████
            ███████████████████████████ ██   ███  ████  ████   ██    ████   ███████████████████████████████
            ███████████████████████████     ████  ████  █████      ██████   ███████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████     ███████████████████
            █████████████████       █████████████████████████████████████████████         █████████████████
            ████████████████          ██████████████████████████████████████████           ████████████████
            ███████████████            █████████████████████████████████████████          █████████████████
            ███████████████            █████████████████████████████  ██████████          █████████████████
            ████████████████          ████          █████████████          ██████             █████████████
            █████████████████        █████          █████████████                             █████████████
            ███████████                        ████████████████████                     ███    ████████████
            ██████████                         █████████████████████████         ██    █████    ███████████
            ██████████    █████   █████████   ███████████████████████████   ███████    ████████████████████
            ██████████   ██████   █████████████████████████████████████████████████    ████████████████████
            ██████████   ██████   █████████████████████████████████████████████████     ███████████████████
            █████████████████      ██████████████████████████████████████████████         █████████████████
            ████████████████         ██████████████████████████████████████████       █     ███████████████
            ███████████████          █████████████████████████████████████████     ██████   ███████████████
            ██████████████     ███    █████████████████████████████████████████  ██████████████████████████
            ███████████████    ████    ████████████████████████████████████████████████████████████████████
            █████████████████████████ █████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
            ███████████████████████████████████████████████████████████████████████████████████████████████
        )"
    };

    std::cout << "Press 'A' to start the animation. Press any other key to stop.\n";

    setNonBlocking(true); // enable raw input mode

    // Wait for user to press 'A' or 'a' to start animation
    while (true) {
        int key = getKeyPressed();
        if (key == 'a' || key == 'A') {
            break;
        } else if (key != -1) {
            std::cout << "Invalid key. Exiting...\n";
            setNonBlocking(false);
            return 0;
        }
        usleep(10000); // 10 ms
    }

    int frameIndex = 0;

    // Start animation loop
    while (true) {
        clearScreen();
        std::cout << frames[frameIndex] << std::endl;
        frameIndex = (frameIndex + 1) % frames.size();

        usleep(10000); // 300 ms

        int key = getKeyPressed();
        if (key != -1 && key != 'a' && key != 'A') {
            break; // Stop if any key other than 'A' is pressed
        }
    }

    clearScreen();
    setNonBlocking(false); // restore terminal settings
    std::cout << "Animation stopped.\n";

    return 0;
}
